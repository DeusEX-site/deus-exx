@echo off
title Управление уведомлениями о капах
chcp 65001 >nul

:start
cls
echo.
echo ================================================================
echo   УПРАВЛЕНИЕ СИСТЕМОЙ УВЕДОМЛЕНИЙ О КАПАХ
echo ================================================================
echo.

echo 1. Показать статус системы
echo 2. Включить уведомления
echo 3. Отключить уведомления
echo 4. Показать доступные чаты
echo 5. Тестировать уведомления
echo 6. Полное тестирование системы
echo 7. Выход
echo.

set /p choice="Выберите действие (1-7): "

if "%choice%"=="1" (
    echo.
    echo ================================================================
    echo   СТАТУС СИСТЕМЫ
    echo ================================================================
    echo.
    php artisan cap-notifications:manage status
    echo.
    echo ================================================================
    pause
    goto start
)

if "%choice%"=="2" (
    echo.
    echo ================================================================
    echo   ВКЛЮЧЕНИЕ УВЕДОМЛЕНИЙ
    echo ================================================================
    echo.
    php artisan cap-notifications:manage enable
    echo.
    echo ================================================================
    pause
    goto start
)

if "%choice%"=="3" (
    echo.
    echo ================================================================
    echo   ОТКЛЮЧЕНИЕ УВЕДОМЛЕНИЙ
    echo ================================================================
    echo.
    php artisan cap-notifications:manage disable
    echo.
    echo ================================================================
    pause
    goto start
)

if "%choice%"=="4" (
    echo.
    echo ================================================================
    echo   ДОСТУПНЫЕ ЧАТЫ
    echo ================================================================
    echo.
    php artisan cap-notifications:manage get-chat-id
    echo.
    echo ================================================================
    pause
    goto start
)

if "%choice%"=="5" (
    echo.
    echo ================================================================
    echo   ТЕСТИРОВАНИЕ УВЕДОМЛЕНИЙ
    echo ================================================================
    echo.
    echo Сначала получите ID чата из пункта 4, затем введите его:
    echo.
    set /p chatId="Введите ID чата для тестирования: "
    
    if not "%chatId%"=="" (
        echo.
        echo Отправка тестового уведомления в чат: %chatId%
        echo.
        php artisan cap-notifications:manage test --chat-id=%chatId%
    ) else (
        echo.
        echo ❌ ID чата не может быть пустым
    )
    
    echo.
    echo ================================================================
    pause
    goto start
)

if "%choice%"=="6" (
    echo.
    echo ================================================================
    echo   ПОЛНОЕ ТЕСТИРОВАНИЕ СИСТЕМЫ
    echo ================================================================
    echo.
    echo Выберите режим тестирования:
    echo 1. С включенными уведомлениями
    echo 2. С отключенными уведомлениями
    echo.
    set /p testMode="Выберите режим (1-2): "
    
    echo.
    
    if "%testMode%"=="1" (
        echo Запуск полного тестирования с включенными уведомлениями...
        echo.
        php artisan test:cap-notifications
    ) else if "%testMode%"=="2" (
        echo Запуск полного тестирования с отключенными уведомлениями...
        echo.
        php artisan test:cap-notifications --disable-notifications
    ) else (
        echo ❌ Неверный выбор
    )
    
    echo.
    echo ================================================================
    pause
    goto start
)

if "%choice%"=="7" (
    echo.
    echo ================================================================
    echo   ВЫХОД
    echo ================================================================
    echo.
    echo Спасибо за использование системы управления уведомлениями!
    echo.
    pause
    exit
)

echo.
echo ❌ Неверный выбор. Попробуйте еще раз.
echo.
pause
goto start 