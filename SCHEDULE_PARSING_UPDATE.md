# Обновление парсинга расписания (Schedule)

## Описание обновлений

Расширена поддержка различных форматов расписания и исправлены проблемы с парсингом.

### Новые поддерживаемые форматы

1. **Формат с точками вместо двоеточий**:
   - `8.30 - 14.30 +3`
   - Автоматически преобразуется в `8:30/14:30` с timezone `GMT+3:00`

2. **Формат без минут**:
   - `10-19 +3`
   - Автоматически добавляются минуты: `10:00/19:00` с timezone `GMT+3:00`

3. **Различные форматы часовых поясов**:
   - `+3` → `GMT+3:00`
   - `GMT+3` → `GMT+3:00`
   - `GMT+03:00` → `GMT+03:00` (без изменений)

4. **Поддержка различных разделителей**:
   - Дефис: `10:00 - 19:00`
   - Длинное тире: `10:00 – 19:00`
   - Слэш: `10:00/19:00`

### Исправленные проблемы

1. **Дублирующиеся поля Schedule**:
   - Если в сообщении несколько полей `Schedule:`, выбирается первое непустое
   - Пустые поля игнорируются

2. **Поддержка CAP в верхнем регистре**:
   - Теперь работает как `Cap:`, так и `CAP:`

3. **Регистронезависимый поиск полей**:
   - Все поля теперь ищутся без учета регистра

4. **Обработка пустых значений**:
   - Если все поля Schedule пустые, используется значение по умолчанию `24/7`
   - Аналогичная логика применена ко всем необязательным полям (см. FIELD_DUPLICATE_HANDLING.md)

### Примеры обработки

#### Пример 1: Формат с точками
```
Schedule: 8.30 - 14.30 +3
```
Результат:
- schedule: `8:30/14:30`
- start_time: `8:30`
- end_time: `14:30`
- timezone: `GMT+3:00`

#### Пример 2: Формат без минут
```
Schedule: 10-19 +3
```
Результат:
- schedule: `10:00/19:00`
- start_time: `10:00`
- end_time: `19:00`
- timezone: `GMT+3:00`

#### Пример 3: Дублирующиеся поля
```
Schedule: 8.30 - 14.30 +3
дополнительные поля, если надо :
Schedule:
```
Результат: Используется первое непустое значение `8.30 - 14.30 +3`

### Тестирование

Для проверки работы парсинга расписания используйте:
```
test-schedule-parsing.bat
```

Тест проверяет:
- Парсинг формата с точками
- Парсинг формата без минут
- Обработку дублирующихся полей
- Стандартный формат с GMT
- Множественные расписания 