# Исправление обработки пустых полей

## Проблема
Поля "Language:", "Funnel:", "Total:" и другие необязательные поля отображались пустыми, даже когда должны были применяться значения по умолчанию.

## Причина
Значения по умолчанию устанавливались только внутри блоков `if (preg_match_all(...))`, но если поле полностью отсутствовало в сообщении, то массивы оставались пустыми и значения по умолчанию не применялись.

## Решение
Добавлена дополнительная проверка после парсинга всех полей в методе `parseStandardCapMessage`:

```php
// Устанавливаем значения по умолчанию для пустых массивов (если поля отсутствуют)
if (empty($languages)) {
    $languages = ['en'];
}
if (empty($funnels)) {
    $funnels = [null];
}
if (empty($totals)) {
    $totals = [-1];
}
if (empty($schedules)) {
    $schedules = ['24/7'];
}
if (empty($pendingAcqs)) {
    $pendingAcqs = [false];
}
if (empty($freezeStatuses)) {
    $freezeStatuses = [false];
}
if (empty($dates)) {
    $dates = [null];
}
```

## Логика обработки
1. **Поле присутствует с данными**: Используются указанные значения
2. **Поле присутствует, но пустое**: Используются значения по умолчанию (внутри блока if)
3. **Поле отсутствует**: Устанавливаются значения по умолчанию (новая логика)

## Значения по умолчанию
- **Language**: 'en' (английский)
- **Funnel**: null (не указана)
- **Total**: -1 (бесконечность)
- **Schedule**: '24/7' (круглосуточно)
- **Date**: null (бессрочно)
- **Pending ACQ**: false (нет)
- **Freeze status on ACQ**: false (нет)

## Тестирование
Для проверки исправления:
```bash
php test_empty_fields_full.php
```

или через батник:
```bash
test-empty-fields-full.bat
```

## Применение к обновлениям
Для метода `processCapUpdate` значения по умолчанию НЕ устанавливаются автоматически, так как при обновлении отсутствие поля означает "не изменять", а не "установить по умолчанию".

## Результат
После исправления все необязательные поля будут отображаться с корректными значениями по умолчанию вместо пустых строк. 