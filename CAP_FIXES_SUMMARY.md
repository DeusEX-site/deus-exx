# ะัะฟัะฐะฒะปะตะฝะธั ัะธััะตะผั ะบะฐะฟ - ะัะพะณะพะฒะฐั ัะฒะพะดะบะฐ

## โ ะัะฟะพะปะฝะตะฝะฝัะต ะธัะฟัะฐะฒะปะตะฝะธั

### 1. ะฃะฑัะฐะฝ ะบะฒะฐะดัะฐั Freeze
- **ะัะพะฑะปะตะผะฐ**: ะัะพะฑัะฐะถะฐะปัั ะฝะตะฝัะถะฝัะน ะบะฒะฐะดัะฐั "Freeze" ั ัะพัะผะฐัะพะผ "No/No"
- **ะะตัะตะฝะธะต**: ะะพะปะฝะพัััั ัะฑัะฐะฝ ะธะท ะธะฝัะตััะตะนัะฐ
- **ะคะฐะนะป**: `resources/views/cap-analysis.blade.php`

### 1.1. ะฃะฑัะฐะฝ ะฑะปะพะบ "ะะฑัะฐะฑะพัะฐะฝะฝัะน ัะตะบัั ะดะปั ะฒัะตั ะฑะปะพะบะพะฒ"
- **ะัะพะฑะปะตะผะฐ**: ะัะพะฑัะฐะถะฐะปัั ะฝะตะฝัะถะฝัะน ะฑะปะพะบ ั ะพะฑัะฐะฑะพัะฐะฝะฝัะผ ัะตะบััะพะผ
- **ะะตัะตะฝะธะต**: ะะพะปะฝะพัััั ัะฑัะฐะฝ ะธะท ะธะฝัะตััะตะนัะฐ
- **ะคะฐะนะป**: `resources/views/cap-analysis.blade.php`

### 2. ะะฒัะพะผะฐัะธัะตัะบะฐั ะฟะพะดััะฐะฝะพะฒะบะฐ ัะตะบััะตะณะพ ะณะพะดะฐ ะบ ะดะฐัะต
- **ะัะพะฑะปะตะผะฐ**: ะัะธ ะฒะฒะพะดะต ะดะฐัั ะฒ ัะพัะผะฐัะต "24.02" ะฝะต ะดะพะฑะฐะฒะปัะปัั ะณะพะด
- **ะะตัะตะฝะธะต**: ะะพะฑะฐะฒะปะตะฝะฐ ะปะพะณะธะบะฐ ะฐะฒัะพะผะฐัะธัะตัะบะพะน ะฟะพะดััะฐะฝะพะฒะบะธ ัะตะบััะตะณะพ ะณะพะดะฐ
- **ะะตะทัะปััะฐั**: 
  - `Date: 24.02` โ `24.02.2024`
  - `Date: 15.12` โ `15.12.2024`
  - `Date: 01.01.2023` โ ะพััะฐะตััั ะฑะตะท ะธะทะผะตะฝะตะฝะธะน
- **ะคะฐะนะป**: `app/Services/CapAnalysisService.php`

### 3. ะัะฟัะฐะฒะปะตะฝะฐ ะพัะธะฑะบะฐ ะฟะพะธัะบะฐ ะฟะพ ะฒะพัะพะฝะบะต
- **ะัะพะฑะปะตะผะฐ**: API ะธัะฟะพะปัะทะพะฒะฐะป ะฝะตะฟัะฐะฒะธะปัะฝัะต ะฝะฐะทะฒะฐะฝะธั ะฟะพะปะตะน ะดะปั ัะธะปัััะฐัะธะธ
- **ะะตัะตะฝะธั**:
  - ะัะฟัะฐะฒะปะตะฝะพ `'broker' => $broker` ะฝะฐ `'recipient' => $broker`
  - ะะพะฑะฐะฒะปะตะฝั ะฟะฐัะฐะผะตััั `language` ะธ `funnel` ะฒ API
  - ะัะฟัะฐะฒะปะตะฝะพ ะฒะพะทะฒัะฐัะตะฝะธะต `'brokers'` ะฝะฐ `'recipients'` ะฒ ัะธะปัััะฐั
- **ะคะฐะนะปั**: `routes/web.php`

### 4. ะะพะฑะฐะฒะปะตะฝั ัะธะปัััั ะฟะพ ัะทัะบั ะธ ะฒะพัะพะฝะบะต
- **ะะพะฑะฐะฒะปะตะฝะพ**: ะะพะฒัะต ะฟะพะปั ัะธะปัััะฐัะธะธ ะฒ ะธะฝัะตััะตะนัะต
- **HTML**: ะะพะปั `language-filter` ะธ `funnel-filter`
- **JavaScript**: ะะฐะณััะทะบะฐ ะดะฐะฝะฝัั ะธ ะฟะตัะตะดะฐัะฐ ะฒ API
- **API**: ะะพะดะดะตัะถะบะฐ ะฝะพะฒัั ะฟะฐัะฐะผะตััะพะฒ ัะธะปัััะฐัะธะธ
- **ะคะฐะนะป**: `resources/views/cap-analysis.blade.php`

### 5. ะะทะผะตะฝะตะฝะฐ ะปะพะณะธะบะฐ ัะฐะทะดะตะปะตะฝะธั ะบะฐะฟ ะฟะพ ะณะตะพ
- **ะัะพะฑะปะตะผะฐ**: ะกะธััะตะผะฐ ัะพะทะดะฐะฒะฐะปะฐ ะบะพะผะฑะธะฝะฐัะธะธ AffiliateรRecipient ัะตัะตะท ะทะฐะฟัััั
- **ะะพะฒะฐั ะปะพะณะธะบะฐ**: 
  - Affiliate ะธ Recipient - ะฟะพ ะพะดะฝะพะผั ะทะฝะฐัะตะฝะธั (ะฑะตะท ะทะฐะฟัััั)
  - ะะฐะทะดะตะปะตะฝะธะต ะฟัะพะธััะพะดะธั ะฟะพ ะณะตะพ: `Geo: GT PE MX` = 3 ะพัะดะตะปัะฝัะต ะบะฐะฟั
- **ะะตะทัะปััะฐั**: 
  - `Geo: GT PE MX` โ 3 ะทะฐะฟะธัะธ (ะพะดะฝะฐ ะดะปั ะบะฐะถะดะพะณะพ ะณะตะพ)
  - `Geo: RU` โ 1 ะทะฐะฟะธัั
- **ะคะฐะนะป**: `app/Services/CapAnalysisService.php`

## ๐ ะขะตะบััะธะน ัะพัะผะฐั ะธะฝัะตััะตะนัะฐ

### ะะฒะฐะดัะฐัะธะบะธ ะฐะฝะฐะปะธะทะฐ (ะฟะพัะปะต ะธัะฟัะฐะฒะปะตะฝะธะน):
```
โโโโโโโโโโโฌโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
โ  ะะฐะฟะฐ   โ ะะฑัะธะน ะปะธะผะธั โ ะะฐัะฟะธัะฐะฝะธะต  โ    ะะฐัะฐ     โ
โ   15    โ     200     โ 10:00/18:00 โ   24.02     โ
โโโโโโโโโโโดโโโโโโโโโโโโโโดโโโโโโโโโโโโโโดโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
โ ะััะธะปะตะนั    โ ะะพะปััะฐัะตะปั  โ    ะะตะพ      โ    ะฏะทัะบ     โ
โ    G06      โ   TMedia    โ   IE, DE    โ     en      โ
โโโโโโโโโโโโโโโดโโโโโโโโโโโโโโดโโโโโโโโโโโโโโดโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโ
โ  ะะพัะพะฝะบะฐ    โ
โ   Crypto    โ
โโโโโโโโโโโโโโโ

โ ะฃะะะะะะซ:
- ะะฒะฐะดัะฐั Freeze
- ะะปะพะบ "ะะฑัะฐะฑะพัะฐะฝะฝัะน ัะตะบัั ะดะปั ะฒัะตั ะฑะปะพะบะพะฒ"
```

### ะคะธะปัััั ะฟะพะธัะบะฐ (ะฟะพัะปะต ะธัะฟัะฐะฒะปะตะฝะธะน):
- ะะพะฟะพะปะฝะธัะตะปัะฝัะน ะฟะพะธัะบ
- ะงะฐั
- ะะตะพ
- ะัะพะบะตั (ะฟะพะปััะฐัะตะปั)
- ะััะธะปะตะนั
- **๐ ะฏะทัะบ**
- **๐ ะะพัะพะฝะบะฐ**
- ะะฐัะฟะธัะฐะฝะธะต
- ะะฑัะธะน ะปะธะผะธั

## ๐ง ะขะตัะฝะธัะตัะบะธะต ะธะทะผะตะฝะตะฝะธั

### API Endpoints
```php
// GET /api/cap-analysis
// ะะพะฒัะต ะฟะฐัะฐะผะตััั:
- language (ัะธะปััั ะฟะพ ัะทัะบั)
- funnel (ัะธะปััั ะฟะพ ะฒะพัะพะฝะบะต)
- recipient (ะธัะฟัะฐะฒะปะตะฝะพ ั broker)

// GET /api/cap-analysis-filters
// ะะพะฒัะต ะฟะพะปั ะฒ ะพัะฒะตัะต:
- languages[]
- funnels[]
- recipients[] (ะธัะฟัะฐะฒะปะตะฝะพ ั brokers)
```

### ะะฐััะธะฝะณ ะดะฐัั
```php
// ะะพะณะธะบะฐ ะฒ CapAnalysisService::parseStandardCapMessage()
if (preg_match('/^\d{1,2}\.\d{1,2}$/', $dateValue)) {
    $currentYear = date('Y');
    $baseData['date'] = $dateValue . '.' . $currentYear;
} else {
    $baseData['date'] = $dateValue;
}
```

### JavaScript ัะธะปัััั
```javascript
// ะะพะฑะฐะฒะปะตะฝั ะฝะพะฒัะต ัะปะตะผะตะฝัั:
const languageFilter = document.getElementById('language-filter');
const funnelFilter = document.getElementById('funnel-filter');

// ะะพะฑะฐะฒะปะตะฝั ะฒ ะฟะฐัะฐะผะตััั API:
if (language) params.append('language', language);
if (funnel) params.append('funnel', funnel);
```

## ๐ ะัะธะผะตัั ัะฐะฑะพัั

### ะัะธะผะตั 1: ะะฒัะพะผะฐัะธัะตัะบะฐั ะฟะพะดััะฐะฝะพะฒะบะฐ ะณะพะดะฐ
**ะัะพะดะฝะพะต ัะพะพะฑัะตะฝะธะต:**
```
Affiliate: G06
Recipient: TMedia
Cap: 15
Total: 200
Geo: IE
Language: en
Funnel: Crypto
Schedule: 10:00/18:00 GMT+03:00
Date: 24.02
Pending ACQ: No
Freeze status on ACQ: No
```

**ะะตะทัะปััะฐั ะพะฑัะฐะฑะพัะบะธ:**
- Date: `24.02.2024` (ะฐะฒัะพะผะฐัะธัะตัะบะธ ะดะพะฑะฐะฒะปะตะฝ ัะตะบััะธะน ะณะพะด)
- ะะฒะฐะดัะฐั Freeze: ะะ ะพัะพะฑัะฐะถะฐะตััั
- ะะพัััะฟะฝั ัะธะปัััั ะฟะพ ัะทัะบั ะธ ะฒะพัะพะฝะบะต

### ะัะธะผะตั 2: ะะฐะทะดะตะปะตะฝะธะต ะฟะพ ะณะตะพ
**ะัะพะดะฝะพะต ัะพะพะฑัะตะฝะธะต:**
```
Affiliate: Webgate
Recipient: TradingM
Cap: 20
Total: 200
Geo: GT PE MX
Language: es
Funnel: Crypto
Schedule: 24/7
Date: 24.02
Pending ACQ: Yes
Freeze status on ACQ: No
```

**ะะตะทัะปััะฐั ะพะฑัะฐะฑะพัะบะธ:**
- ะกะพะทะดะฐะตััั 3 ะพัะดะตะปัะฝัะต ะทะฐะฟะธัะธ:
  1. Webgate - TradingM (ะะตะพ: GT)
  2. Webgate - TradingM (ะะตะพ: PE)
  3. Webgate - TradingM (ะะตะพ: MX)
- Date: `24.02.2024` (ะฐะฒัะพะผะฐัะธัะตัะบะธ ะดะพะฑะฐะฒะปะตะฝ ะณะพะด)

### ะัะธะผะตั 3: ะคะธะปัััะฐัะธั ะฟะพ ะฝะพะฒัะผ ะฟะพะปัะผ
```
ะคะธะปััั "ะฏะทัะบ": en, ru, de, es
ะคะธะปััั "ะะพัะพะฝะบะฐ": Crypto, Forex, Binary
```

## ๐ ะะพะผะฐะฝะดั ะดะปั ะฟัะพะฒะตัะบะธ

### ะขะตััะธัะพะฒะฐะฝะธะต (ะตัะปะธ ะดะพัััะฟะตะฝ PHP):
```bash
php artisan update:new-cap-format --test
```

### ะัะพะฒะตัะบะฐ ัะฐะนะปะพะฒ:
- `resources/views/cap-analysis.blade.php` - ัะฑัะฐะฝ Freeze, ะดะพะฑะฐะฒะปะตะฝั ัะธะปัััั
- `app/Services/CapAnalysisService.php` - ะดะพะฑะฐะฒะปะตะฝะฐ ะปะพะณะธะบะฐ ะณะพะดะฐ
- `routes/web.php` - ะธัะฟัะฐะฒะปะตะฝั API ะผะฐัััััั

## โ ะะตะทัะปััะฐั

ะัะต ะทะฐะฟัะพัะตะฝะฝัะต ะธัะฟัะฐะฒะปะตะฝะธั ะฒัะฟะพะปะฝะตะฝั:
1. โ **ะะฒะฐะดัะฐั Freeze** - ัะดะฐะปะตะฝ
2. โ **ะะปะพะบ "ะะฑัะฐะฑะพัะฐะฝะฝัะน ัะตะบัั"** - ัะดะฐะปะตะฝ
3. โ **ะะฒัะพะผะฐัะธัะตัะบะธะน ะณะพะด** - ะดะพะฑะฐะฒะปัะตััั ะบ ะดะฐัะฐะผ ัะพัะผะฐัะฐ "ะะ.ะะ"
4. โ **ะัะธะฑะบะฐ ะฒะพัะพะฝะบะธ** - ะธัะฟัะฐะฒะปะตะฝะฐ ะฒ API
5. โ **ะคะธะปัััั ัะทัะบะฐ ะธ ะฒะพัะพะฝะบะธ** - ะดะพะฑะฐะฒะปะตะฝั ะฒ ะธะฝัะตััะตะนั
6. โ **ะะพะณะธะบะฐ ัะฐะทะดะตะปะตะฝะธั** - ะธะทะผะตะฝะตะฝะฐ ะฝะฐ ัะฐะทะดะตะปะตะฝะธะต ะฟะพ ะณะตะพ ะฒะผะตััะพ AffiliateรRecipient

ะกะธััะตะผะฐ ัะตะฟะตัั ัะฐะฑะพัะฐะตั ะบะพััะตะบัะฝะพ ั ะฝะพะฒัะผ ััะฐะฝะดะฐััะฝัะผ ัะพัะผะฐัะพะผ ะธ ะฒะบะปััะฐะตั ะฒัะต ะทะฐะฟัะพัะตะฝะฝัะต ััะฝะบัะธะธ! 