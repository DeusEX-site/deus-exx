# Исправление логики парсинга Schedule и Date

## Проблемы

### 1. Schedule - неправильная привязка по колонкам
**Проблема:** Расписание `"18:00/01:00 18:00/02:00 GMT+03:00"` применялось одинаково ко всем записям
**Должно быть:**
- Запись 1: `18:00/01:00`
- Запись 2: `18:00/02:00 GMT+03:00`  
- Запись 3: `24/7` (по умолчанию)

### 2. Date - поддержка только запятых
**Проблема:** Даты разбивались только по запятым
**Требование:** Поддержка пробелов и запятых как разделителей

## Решения

### 1. Исправление parseScheduleValues()
```php
// БЫЛО: Разбивка только по запятым
$segments = explode(',', $value);

// СТАЛО: Разбивка по запятым И пробелам  
$allParts = preg_split('/[,\s]+/', $value);
```

**Новая логика:**
- Разбивает по пробелам и запятым
- Находит отдельные времена `HH:MM/HH:MM`
- Привязывает GMT к предшествующему времени
- Игнорирует отдельные GMT без времени

### 2. Исправление парсинга Date
```php
// БЫЛО: Только запятые
$dateValues = $this->parseMultipleValues($matches[1], true);

// СТАЛО: Пробелы и запятые
$dateValues = $this->parseMultipleValues($matches[1]);
```

## Тестирование

### Тестовое сообщение:
```
Affiliate: G06
Recipient: TMedia  
Cap: 15 20 30
Geo: DE AT CH
Language: de
Total: 100 200 300
Schedule: 18:00/01:00 18:00/02:00 GMT+03:00
Date: 24.02 25.02
```

### Ожидаемый результат:
1. **Запись 1:** Cap=15, Geo=DE, Schedule="18:00/01:00", Date="24.02.2024"
2. **Запись 2:** Cap=20, Geo=AT, Schedule="18:00/02:00 GMT+03:00", Date="25.02.2024"  
3. **Запись 3:** Cap=30, Geo=CH, Schedule="24/7", Date=null

### Запуск теста:
```bash
.\test-schedule-date-fix.bat
```

## Принципы работы

### Schedule логика:
- **Одно значение** → применяется ко всем записям
- **Несколько значений** → привязка по порядку (Schedule[0]↔Cap[0], Schedule[1]↔Cap[1])
- **Не хватает значений** → заполнение "24/7"

### Date логика:
- **Разделители:** пробелы, запятые
- **Автодобавление года:** `24.02` → `24.02.2024`
- **Пустые значения** → `null` (бесконечность) 